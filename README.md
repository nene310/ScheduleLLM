# ScheduleLLM - 智能课表生成工具

**ScheduleLLM** 是一个纯前端的 Web 应用程序，专为高校学生和教师设计。它能将复杂的 Excel 课程表文件解析为清晰、直观的月历视图，并支持导入到手机日历（iOS/Android）或打印为 PDF。

## 🌟 开发背景

高校教务系统导出的课程表通常是以“一周”为循环单元的静态表格。然而在实际教学中，情况远比“一格一课”复杂：同一个时间单元格内可能堆叠了多门不同周次的课程，这些课程可能存在单双周轮换、各周次授课地点不固定等复杂情况。这意味着，一张看似清爽的 Excel 表格，实际上在每个细小的单元格中都高度“压缩”了多维度的、动态的教学时空信息。

对于广大师生而言，每次提取并解读课表信息的过程，实质上都是一次非常耗费精力的“大脑解压缩”过程。由于信息密度巨大，传统的手动解读方式不仅效率低下，而且极其容易出错（例如记错周次、走错教室等）。因此，开发一个能够对“压缩课表”进行自动解析（解压缩）并还原为直观日程的程序工具，不仅能极大程度上解放大脑逻辑，更是提升校园生活和工作效率的一项刚需。

## 📅 主要功能

### 1. 强大的双模式解析
*   **传统正则解析**: 快速解析标准格式课程字符串，例如 `(1-2节)2-6周,8-12周(双)/一教A101/高等数学`。
*   **LLM 智能识别 (新增)**: 集成阿里云通义千问 (Qwen) 等大语言模型，能够理解复杂的自然语言描述、非标格式或乱序文本，大幅提升解析成功率。支持自动重试与降级策略，确保稳定性。
*   **自动容错**: 支持标准格式以及包含缺失字段的非标准格式，自动提取周次、地点和班级信息。
*   **周次处理**: 完美支持单周、双周、非连续周（如 `2-6,8,10周`）的解析。

### 2. 交互式月历与编辑
*   **月度浏览**: 清晰展示每个月的课程安排。
*   **详细展示**: 课程卡片显示上课地点、节次（支持连堂课显示，如 `1-2节`）。
*   **时段区分**: 自动根据上课时间用不同颜色区分上午、下午和晚上课程。
*   **周次标记**: 在每周一（或每月1号）自动通过小标签显示当前是“第几周”，不再迷路。
*   **人工校正**: 支持直接在月历视图中点击课程名称或地点进行修改，方便修正解析错误。

### 3. 多平台导出与分享
*   **ICS 日历导出**:
    *   **通用格式**: 适用于大多数日历应用。
    *   **iOS (iPhone)**: 优化描述显示。
    *   **Android (Google Calendar)**: 添加提醒设置。
    *   **Windows (Outlook)**: 添加 Outlook 专用的分类和忙闲状态字段。
*   **vCard/VCF 导出 (新增)**: 支持导出为 vCalendar 1.0 (.vcs) 格式，兼容旧版通讯录日程导入。
*   **网页存档**: 一键导出为离线 `.html` 文件，保留所有样式和悬浮交互，方便在任何设备查看。
*   **A4 打印优化**:
    *   专门设计的打印样式（CSS `@media print`）。
    *   自动生成所有有课月份的连续视图。
    *   优化为 **A4 纵向 (Portrait)** 布局，自动分页，适合打印归档。

### 4. 个性化配置
*   **开学时间**: 可自由设置学期第一周的周一日期，系统自动推算所有课程的具体日期。
*   **节次微调**: 支持自定义每天 10 节课的具体开始和结束时间。

---

## 🚀 快速开始

### 方式一：直接使用 (GitHub Pages)
如果本项目已部署到 GitHub Pages，直接访问链接即可使用。

### 方式二：本地运行
由于本项目是纯静态网页（HTML/CSS/JS），无需后端服务器。
1.  下载本项目代码。
2.  直接双击打开 `index.html` 文件即可在浏览器中运行。

---

## ⚙️ 开发者配置 (高级)

为了方便开发者调试 LLM 功能，避免每次重复输入 API Key，本项目支持通过配置文件自动注入密钥。

### 1. 本地开发配置
1.  复制 `config.template.js` 文件并重命名为 `config.js`。
2.  编辑 `config.js`，填入你的阿里云 DashScope API Key：
    ```javascript
    window.AppConfig = {
        apiKey: "sk-your-actual-key-here",
        // ...
    };
    ```
3.  刷新 `index.html`，系统将自动加载密钥并锁定输入框。
    *   *注意：`config.js` 已被加入 `.gitignore`，请勿将含有真实密钥的文件提交到版本控制系统。*

### 2. CI/CD 自动部署
在自动化部署环境中，可以通过环境变量生成配置文件：
1.  设置环境变量 `API_KEY` (以及可选的 `LLM_BASE_URL`, `LLM_MODEL`)。
2.  运行注入脚本：
    ```bash
    node inject_env.js
    ```
3.  该脚本会读取环境变量并生成 `config.js`，供前端页面调用。

### 3. GitHub Pages 环境配置
1.  进入 GitHub 仓库 -> "Settings" -> "Secrets and variables" -> "Actions"。
2.  点击 "New repository secret"，添加 `API_KEY` 秘密，值为你的阿里云 API Key。
3.  创建 `.github/workflows/deploy.yml` 文件，添加以下内容：
    ```yaml
    name: Deploy to GitHub Pages
    on:
      push:
        branches: [ main ]
    jobs:
      deploy:
        runs-on: ubuntu-latest
        permissions:
          contents: write
        steps:
          - uses: actions/checkout@v4
          - name: Set up Node.js
            uses: actions/setup-node@v4
            with:
              node-version: '20'
          - name: Generate config.js
            run: node inject_env.js
            env:
              API_KEY: ${{ secrets.API_KEY }}
          - name: Deploy to GitHub Pages
            uses: peaceiris/actions-gh-pages@v4
            with:
              github_token: ${{ secrets.GITHUB_TOKEN }}
              publish_dir: .
    ```

## 📖 使用指南

1.  **上传课表**: 点击左侧边栏的 **"选择 Excel 课表"** 按钮，上传你的课程表文件。
2.  **设置开学日期**: 在 **"开学第一周周一"** 处选择本学期的起始日期。
3.  **生成日程**: 点击绿色 **"生成日程"** 按钮。右侧将显示解析出的月历。
4.  **导出/打印**:
    *   **保存网页**: 点击 **"保存为网页 (HTML)"** 可下载当前课表的精简网页版。此文件包含最完整的课程信息展示，且保留交互效果，是查看详情的最佳方式。
    *   **打印**: 点击 **"打印月历"**，系统会自动调用浏览器打印预览（推荐选择 "另存为 PDF"）。*注意：由于打印页面布局限制，预览/打印时某些极长的课程信息可能会被部分截断。*
    *   **导入手机**: 在下拉菜单中选择你的设备类型（如 iPhone），然后点击 **"导出 ICS 日历"**。
        *   **iOS (iPhone) 用户建议**：将导出的 `.ics` 文件先发送到 MacBook 导入“日历”应用，然后通过 iCloud 自动同步到 iPhone，这样稳定性最高且能保留完整的提醒设置。也可以直接通过 AirDrop 或邮件发送到手机打开。

---

## 🛠️ 技术栈
*   **核心**: HTML5, CSS3, Vanilla JavaScript (ES6+)
*   **Excel 处理**: [SheetJS (xlsx)](https://sheetjs.com/) Community Edition
*   **字体**: Inter (Google Fonts)

## 📄 许可证
本项目开源，仅供学习交流使用。
